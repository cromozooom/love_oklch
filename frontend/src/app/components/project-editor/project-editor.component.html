<div class="project-editor">
  <div class="editor-header">
    <h1 class="editor-title">
      {{ project()?.name || "Project Editor" }}
    </h1>
    <div class="editor-actions">
      @if (hasUnsavedChanges()) {
      <div class="saving-indicator">
        @if (isSaving()) {
        <span class="saving-text">Saving...</span>
        <div class="saving-spinner"></div>
        } @else {
        <span class="unsaved-text">Unsaved changes</span>
        }
      </div>
      }
      <app-undo-redo-controls
        [projectId]="projectId()"
        (undoExecuted)="onUndoExecuted()"
        (redoExecuted)="onRedoExecuted()"
      >
      </app-undo-redo-controls>
    </div>
  </div>

  <div class="editor-content">
    <!-- Loading State -->
    <div *ngIf="isLoading()" class="loading-state">
      <div class="loading-spinner"></div>
      <p>Loading project...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error()" class="error-state">
      <div class="error-icon">⚠️</div>
      <h3>Error Loading Project</h3>
      <p>{{ error() }}</p>
      <button
        type="button"
        class="retry-button"
        (click)="loadProject(projectId())"
      >
        Try Again
      </button>
    </div>

    <!-- Project Editor Content -->
    <div *ngIf="!isLoading() && !error() && project()" class="editor-main">
      <div class="editor-form-section">
        <app-project-form
          [project]="project()!"
          [mode]="'edit'"
          (projectUpdated)="onProjectUpdated()"
        >
        </app-project-form>
      </div>

      <div class="editor-sidebar">
        <app-modification-history
          [projectId]="projectId()"
          [modifications]="modifications()"
          [loading]="modificationsLoading()"
          [error]="modificationsError()"
        >
        </app-modification-history>
      </div>
    </div>
  </div>
</div>
